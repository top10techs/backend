<!DOCTYPE html>
<html lang="en"> 
<head>
  <title>jQuery Crud</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style>
    @media (min-width: 576px) {
      .jumbotron {
        padding: 1rem 2rem;
      }
    }
    .errdiv{
      color: red;
      font-weight: bold;
    }

    label {
      margin-bottom: 0;
    }

    .tdaction {
      width: 15%;
    }

    .tdSr {
      width: 7%;
    }

    .jumbotron {
      margin-bottom: 0.5rem;
    }

    strong {
      font-size: 24px !important;
    }

    input.largerCheckbox {
      width: 20px;
      height: 20px;
    }
  </style>
</head> 
<body>
  <div class="container">
    <div class="jumbotron text-center bg-success text-white">
      <h2>jQuery Crud With Local Storage</h2>
      <h4> Insert, Update & Delete Operation</h4>
    </div>
    <div class="form-row">
      <div class="col-md-3">
        <label>Name <span class="errdiv"> *</span></label>
        <input id="txtName" type="text" class="form-control txt txtName" placeholder="Enter Name" required>
        <input id="txtId" type="hidden" class="form-control txt">
      </div>
      <div class="col-md-3 col-sm-6 col-6">
        <label>Category<span class="errdiv"> *</span></label>
        <input id="txtCategory" type="text" minlength="10" maxlength="10"
          class="form-control txt txtCategory" placeholder="Category" required>
      </div>
      <div class="col-md-3 col-sm-6 col-6">
        <label>Announced</label>
        <input id="txtAnnounced" type="text" class="form-control txt txtAnnounced" minlength="10" maxlength="10"
          placeholder="Announced">
      </div>
    </div>
 <div class="form-row">
   <div class="col-md-3 col-sm-6 col-6">
        <label>Release date</label>
        <input id="txtRelease" type="text" class="form-control txt txtRelease" minlength="10" maxlength="10"
          placeholder="Released date">
      </div></div>
    <div class="row pt-2">
      <div class="col-md-2">
        <button type="button" class="btn btn-success" id="btnSave">Save</button>
      </div>
      <div class="col-md-2">
        <button type="button" class="btn btn-secondary" id="btnClear">Clear</button>
      </div>
    </div>
    <div class="row pt-3">
      <div class="col-md-12 col-sm-12 col-12 p-2 ">
        <table id="tblData" class="table table-bordered table-hover table-striped">
          <thead>
            <tr>
              <th>Sr No</th>
              <th> Name</th>
             <th data-field="1a" data-filter-control="select" data-sortable="true">Category</th>
        <th data-field="1b" data-filter-control="select" data-sortable="true">Announced</th>
        <th data-field="1c" data-filter-control="select" data-sortable="true">Release date</th>
        <th data-field="2" data-filter-control="select" data-sortable="true">Type</th>
        <th data-field="3" data-filter-control="select" data-sortable="true">Size</th>
        <th data-field="4" data-filter-control="select" data-sortable="true">Resolution</th>
        <th data-field="5" data-filter-control="select" data-sortable="true">Aspect ratio</th>
        <th data-field="6" data-filter-control="select" data-sortable="true">PPi</th>
        <th data-field="7" data-filter-control="select" data-sortable="true">Refresh rate</th>
        <th data-field="8" data-filter-control="select" data-sortable="true">Max rated brightness</th>
        <th data-field="9" data-filter-control="select" data-sortable="true">Max brightness in HDR</th>
        <th data-field="10" data-filter-control="select" data-sortable="true">HDR support</th>
        <th data-field="11" data-filter-control="select" data-sortable="true">Screen protection</th>
        <th data-field="12" data-filter-control="select" data-sortable="true">Screen to body ratio</th>
        <th data-field="13" data-filter-control="select" data-sortable="true">Display features</th>
        <th data-field="14" data-filter-control="select" data-sortable="true">RGB color space</th>
        <th data-field="15" data-filter-control="select" data-sortable="true">PWM</th>
        <th data-field="16" data-filter-control="select" data-sortable="true">Response time</th>
        <th data-field="17" data-filter-control="select" data-sortable="true">Contrast</th>
        <th data-field="18" data-filter-control="select" data-sortable="true">Height</th>
        <th data-field="19" data-filter-control="select" data-sortable="true">Width</th>
        <th data-field="20" data-filter-control="select" data-sortable="true">Thickness</th>
        <th data-field="20a" data-filter-control="select" data-sortable="true">Weight</th>
        <th data-field="21" data-filter-control="select" data-sortable="true">Waterproof</th>
        <th data-field="22" data-filter-control="select" data-sortable="true">Rear material</th>
        <th data-field="23" data-filter-control="select" data-sortable="true">Frame material</th>
        <th data-field="24" data-filter-control="select" data-sortable="true">Colors</th>
        <th data-field="25" data-filter-control="select" data-sortable="true">Fingerprint scanner</th>
        <th data-field="26" data-filter-control="select" data-sortable="true">Chipset</th>
        <th data-field="27" data-filter-control="select" data-sortable="true">Max clock</th>
        <th data-field="28" data-filter-control="select" data-sortable="true">Cpu cores</th>
        <th data-field="29" data-filter-control="select" data-sortable="true">Architecture</th>
        <th data-field="30" data-filter-control="select" data-sortable="true">Lithography process</th>
        <th data-field="31" data-filter-control="select" data-sortable="true">Graphics</th>
        <th data-field="32" data-filter-control="select" data-sortable="true">GPU clock</th>
        <th data-field="33" data-filter-control="select" data-sortable="true">FLOPS</th>
        <th data-field="34" data-filter-control="select" data-sortable="true">RAM size</th>
        <th data-field="35" data-filter-control="select" data-sortable="true">Memory type</th>
        <th data-field="36" data-filter-control="select" data-sortable="true">Memory clock</th>
        <th data-field="37" data-filter-control="select" data-sortable="true">Channels</th>
        <th data-field="38" data-filter-control="select" data-sortable="true">Storage size</th>
        <th data-field="39" data-filter-control="select" data-sortable="true">Storage type</th>
        <th data-field="40" data-filter-control="select" data-sortable="true">Memory card</th>
        <th data-field="41" data-filter-control="select" data-sortable="true">Memory card max size</th>
        <th data-field="42" data-filter-control="select" data-sortable="true">CPU Antutu</th>
        <th data-field="43" data-filter-control="select" data-sortable="true">GPU Antutu</th>
        <th data-field="44" data-filter-control="select" data-sortable="true">Memory Antutu</th>
        <th data-field="45" data-filter-control="select" data-sortable="true">UX Antutu</th>
        <th data-field="45a" data-filter-control="select" data-sortable="true">Total antutu</th>
<th data-field="45b" data-filter-control="select" data-sortable="true">Stability</th>
<th data-field="45c" data-filter-control="select" data-sortable="true">Graphics test</th>
<th data-field="45d" data-filter-control="select" data-sortable="true">Graphics score</th>
<th data-field="45e" data-filter-control="select" data-sortable="true">PC Mark 3.0 score</th>
        <th data-field="46" data-filter-control="select" data-sortable="true">Operating system</th>
        <th data-field="47" data-filter-control="select" data-sortable="true">ROM</th>
        <th data-field="48" data-filter-control="select" data-sortable="true">OS size</th>
        <th data-field="49" data-filter-control="select" data-sortable="true">Battery Capacity</th>
        <th data-field="50" data-filter-control="select" data-sortable="true">Charge power</th>
        <th data-field="51" data-filter-control="select" data-sortable="true">Battery type</th>
        <th data-field="52" data-filter-control="select" data-sortable="true">Replaceable</th>
        <th data-field="53" data-filter-control="select" data-sortable="true">Wireless charging</th>
        <th data-field="54" data-filter-control="select" data-sortable="true">Reverse charging</th>
        <th data-field="55" data-filter-control="select" data-sortable="true">Fast charging</th>
        <th data-field="56" data-filter-control="select" data-sortable="true">Full charging time</th>
        <th data-field="57" data-filter-control="select" data-sortable="true">Camera Matrix</th>
        <th data-field="58" data-filter-control="select" data-sortable="true">Image resolution (back)</th>
        <th data-field="59" data-filter-control="select" data-sortable="true">Zoom</th>
        <th data-field="60" data-filter-control="select" data-sortable="true">Flash</th>
        <th data-field="61" data-filter-control="select" data-sortable="true">Stabilization</th>
        <th data-field="62" data-filter-control="select" data-sortable="true">8k video recording</th>
        <th data-field="63" data-filter-control="select" data-sortable="true">4K video recording</th>
        <th data-field="64" data-filter-control="select" data-sortable="true">1080p video recording</th>
        <th data-field="65" data-filter-control="select" data-sortable="true">Slow motion</th>
        <th data-field="66" data-filter-control="select" data-sortable="true">Angle of widest lens</th>
        <th data-field="67" data-filter-control="select" data-sortable="true">Lenses</th>
        <th data-field="68" data-filter-control="select" data-sortable="true">Wide (main) Lens</th>
        <th data-field="69" data-filter-control="select" data-sortable="true">Ultra wide Lens</th>
        <th data-field="70" data-filter-control="select" data-sortable="true">Macro Lens</th>
        <th data-field="71" data-filter-control="select" data-sortable="true">Depth Lens</th>
        <th data-field="72" data-filter-control="select" data-sortable="true">Camera features</th>
        <th data-field="73" data-filter-control="select" data-sortable="true">Selfie(MP)</th>
        <th data-field="74" data-filter-control="select" data-sortable="true">Image resolution</th>
        <th data-field="75" data-filter-control="select" data-sortable="true">Aperture</th>
        <th data-field="76" data-filter-control="select" data-sortable="true">Pixel size</th>
<th data-field="76a" data-filter-control="select" data-sortable="true">Sensor type</th>
        <th data-field="77" data-filter-control="select" data-sortable="true">Sensor size</th>
        <th data-field="78" data-filter-control="select" data-sortable="true">Video resolution (front)</th>
        <th data-field="79" data-filter-control="select" data-sortable="true">Wi-fi standard</th>
        <th data-field="80" data-filter-control="select" data-sortable="true">Wi-fi features</th>
        <th data-field="81" data-filter-control="select" data-sortable="true">Bluetooth versions</th>
        <th data-field="82" data-filter-control="select" data-sortable="true">Bluetooth features</th>
        <th data-field="83" data-filter-control="select" data-sortable="true">USB type</th>
        <th data-field="84" data-filter-control="select" data-sortable="true">USb version</th>
        <th data-field="85" data-filter-control="select" data-sortable="true">USB features</th>
        <th data-field="86" data-filter-control="select" data-sortable="true">GPS</th>
        <th data-field="87" data-filter-control="select" data-sortable="true">NFC</th>
        <th data-field="88" data-filter-control="select" data-sortable="true">Infrared port</th>
        <th data-field="89" data-filter-control="select" data-sortable="true">No of SIM</th>
        <th data-field="90" data-filter-control="select" data-sortable="true">Type of sim card</th>
        <th data-field="91" data-filter-control="select" data-sortable="true">Multi Sim mode</th>
        <th data-field="92" data-filter-control="select" data-sortable="true">eSIM support</th>
        <th data-field="93" data-filter-control="select" data-sortable="true">Hybrid support</th>
        <th data-field="94" data-filter-control="select" data-sortable="true">Lte Cat</th>
        <th data-field="95" data-filter-control="select" data-sortable="true">2G network</th>
        <th data-field="96" data-filter-control="select" data-sortable="true">3G networks</th>
        <th data-field="97" data-filter-control="select" data-sortable="true">4G networks</th>
        <th data-field="98" data-filter-control="select" data-sortable="true">5G</th>
        <th data-field="99" data-filter-control="select" data-sortable="true">Speaker</th>
        <th data-field="100" data-filter-control="select" data-sortable="true">Headphone audio jack</th>
        <th data-field="101" data-filter-control="select" data-sortable="true">FM radio</th>
        <th data-field="102" data-filter-control="select" data-sortable="true">Dolby Atmos</th>
        <th data-field="103" data-filter-control="select" data-sortable="true">Category</th>
        <th data-field="104" data-filter-control="select" data-sortable="true">Announced</th>
        <th data-field="105" data-filter-control="select" data-sortable="true">Release date</th>
        <th data-field="106" data-filter-control="select" data-sortable="true">Sensors</th>
        <th data-field="107" data-filter-control="select" data-sortable="true">Box</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>
          <tbody> 
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <script>
    var emptyRow = "<tr><td colspan='6' class='text-center'> No Records Available</td></tr>";
    $(document).ready(function () {
      loadDataFromLocal();
      $('#tblData').on('click', '.btn-edit', function () {
        debugger;
        const name = $(this).parent().parent().find(".txtName").html();
        const category = $(this).parent().parent().find(".txtCategory").html();
        const announced = $(this).parent().parent().find(".txtAnnounced").html();
        const release = $(this).parent().parent().find(".txtRelease").html();
        const id = $(this).parent().parent().find(".txtName").attr("data-id");
        $("#txtName").val(name);
        $("#txtCategory").val(category);
        $("#txtAnnounced").val(announced);
        $("#txtRelease").val(release);
        $("#txtId").val(id);
        $("#btnSave").text("Update");
      });

      $('#tblData').on('click', '.btn-delete', function () {
        debugger;
        const id = $(this).parent().parent().find(".txtName").attr("data-id");
        deleteDataFromLocal(id);
      });

      $("#btnSave").click(function () {
        debugger;
        if ($("#txtId").val() == '') {
          addDataToLocal();
        } else {
          updateDataFromLocal();
        }
      });

      $("#btnClear").click(function () {
        debugger;
        clearForm();
      });
    });

    function clearForm() {
      debugger;
      $("#txtName").val("");
      $("#txtCategory").val("");
      $("#txtAnnounced").val("");
      $("#txtRelease").val("");
      $("#btnSave").text("Add");
    }

    function addEmptyRow() {
      debugger;
      if ($("#tblData tbody").children().children().length == 0) {
        $("#tblData tbody").append(emptyRow);
      }
    }

    function loadDataFromLocal() {
      debugger;
      let localData = localStorage.getItem('localData');
      if (localData) {
        $("#tblData tbody").html("");
        let localArray = JSON.parse(localData);
        let index = 1;
        localArray.forEach(element => {
          let dynamicTR = "<tr>";
          dynamicTR = dynamicTR + "<td> " + index + "</td>";
          dynamicTR = dynamicTR + "<td class='txtName'  data-id=" + element.id + ">" + element.name + "</td>";
          dynamicTR = dynamicTR + "<td class='txtCategory'>" + element.category + "</td>";
          dynamicTR = dynamicTR + "<td class='txtAnnounced'>" + element.announced + "</td>";
          dynamicTR = dynamicTR + "<td class='txtRelease'>" + element.release + "</td>";
          dynamicTR = dynamicTR + "    <td class='tdAction text-center'>";
          dynamicTR = dynamicTR + "        <button class='btn btn-sm btn-success btn-edit'> Edit</button>";
          dynamicTR = dynamicTR + "        <button class='btn btn-sm btn-danger btn-delete'> Delete</button>";
          dynamicTR = dynamicTR + "    </td>";
          dynamicTR = dynamicTR + " </tr>";
          $("#tblData tbody").append(dynamicTR);
          index++;
        });
      }
      addEmptyRow();
    }

    function addDataToLocal() {
      debugger;
      let localData = localStorage.getItem('localData');
      if (localData) {
        let localArray = JSON.parse(localData);
        const obj = {
          id: localArray.length + 1,
          name: $("#txtName").val(),
          category: $("#txtCategory").val(),
          announced: $("#txtAnnounced").val(),
          release: $("#txtRelease").val()
        };
        localArray.push(obj);
        localStorage.setItem('localData', JSON.stringify(localArray));
        loadDataFromLocal();
      } else {
        const arryObj = [];
        const obj = {
          id: 1,
          name: $("#txtName").val(),
          category: $("#txtCategory").val(),
          announced: $("#txtAnnounced").val(),
          address: $("#txtRelease").val()
        };
        arryObj.push(obj);
        localStorage.setItem('localData', JSON.stringify(arryObj));
        loadDataFromLocal();
      }
      clearForm();
    }

    function updateDataFromLocal() {
      debugger;
      let localData = localStorage.getItem('localData');
      let localArray = JSON.parse(localData);
      const oldRecord = localArray.find(m => m.id == $("#txtId").val());
      oldRecord.name = $("#txtName").val();
      oldRecord.category = $("#txtCategory").val();
      oldRecord.announced = $("#txtAnnounced").val();
      oldRecord.address = $("#txtRelease").val();
      localStorage.setItem('localData', JSON.stringify(localArray));
      loadDataFromLocal();
      clearForm();
    }

    function deleteDataFromLocal(id) {
      debugger;
      let localData = localStorage.getItem('localData');
      let localArray = JSON.parse(localData);
      let i = 0;
      while (i < localArray.length) {
        if (localArray[i].id === Number(id)) {
          localArray.splice(i, 1);
        } else {
          ++i;
        }
      }
      localStorage.setItem('localData', JSON.stringify(localArray));
      loadDataFromLocal();
    }

  </script>
</body>

</html>
